import numpy

levs = numpy.array([
0.4106514794367926,
1.1918478204305485,
1.1937247044806525,
2.4250341989806548,
2.520499470905123,
3.6575561245247985,
4.2375599672490445,
4.9591072986568,
5.32408982989825,
5.53302626395406,
5.7238375805347195,
6.451327858171827,
6.9819350049943445,
7.274864270327964,
7.417987103335942,
7.56,
7.658727193831803,
7.6823370981121775,
7.761727546899718,
8.752674732583106,
9.594148380199881,
9.623360076303971,
10.4732956313689,
11.070186440739331,
12.003466462633385,
12.233223472996695,
12.58628301448323,
12.717516900121385,
12.941844382929,
13.370741266439396,
13.45591965860008,
13.457103426972285,
13.606780654686629,
13.660469681935394,
14.048030907635756,
14.168895861084824,
14.216781533860116,
15.322731574305351,
15.768884650115066,
15.852637198076,
16.31020713099936,
16.346806784584242,
16.564782650069994,
16.631062807413002,
16.82855168032075,
17.015197121499632,
17.614763559217185,
17.626624527935892,
17.7015069605063,
17.73554644368248,
17.863133809092375,
17.884496148920697,
17.889313133482837,
17.89095207237235,
18.2876167307437,
18.368624686608218,
18.59865155800245,
19.14516553150205,
19.38423900460162,
19.576843655314363,
19.659063360684303,
19.84291734908492,
20.099343193546066,
20.20340315241692,
20.375098920541188,
20.931536792364604,
21.278683379072888,
21.862862045464716,
22.03837522755948,
22.178535371299148,
22.47241803333492,
22.482797000256237,
22.501483332626368,
23.136558468102287,
23.170593692891746,
23.32609541992018,
23.535319638697352,
23.642926284017943,
23.786604501779923,
23.958267537151144,
24.085066736285572,
24.931952858184967,
24.988867640581883,
25.61575122818125,
25.8354579693886,
26.257056551509194,
26.345526394183405,
26.805927536576675,
27.127402206337894,
28.093293554871398,
28.93294002409437,
29.006858784184484,
29.179612492770392,
29.395824063367186,
30.35705030448943,
30.700494810945568,
31.129287037034196,
32.2489163057689,
32.68488614844181,
32.712162579183946,
32.78049347783005,
32.797313881035706,
33.095283152578645,
33.65068848154219,
33.96142233283603,
34.55737750564944,
34.572307063829875,
35.056882026916554,
36.03446593284156,
36.524071268042775,
37.404393131159225,
38.36986800190785,
38.62302069272216,
38.643435917842744,
39.203135176073616,
39.35181191818041,
39.51116791783542,
39.87498976088021,
39.93948156910909,
40.2776629421826,
40.337747654698674,
40.72896258731947,
41.918468628875395,
42.63194099638714,
42.93427958873248,
42.97526671533464,
43.095263573069325,
43.118543249085704,
43.311563305024464,
43.767741011469575,
44.36422720541313,
44.525549751406594,
44.98289593827953,
45.4254827771699,
45.812812517271105,
45.83590142714242,
46.107332442451145,
46.606058960761004,
46.72203880111719,
47.193933019274226,
49.235789182890166,
49.3628361804546,
49.9465371411259,
50.06821959962138,
50.62740061363722,
51.49385824668752,
51.894997117651464,
52.383899487472476,
52.742946272636225,
53.10340022068411,
53.81715950147048,
54.04758484713293,
54.27967561194178,
54.995380953119565,
55.091952376661006,
55.51962720670521,
55.99578433709818,
56.16929051902088,
56.498388597702544,
56.54775905032884,
56.83087214349038,
57.718399782023155,
58.06734462793608,
58.22045548016301,
58.40484970343543,
58.61360542657054,
58.61987915225147,
58.9915534219429,
59.37488290916399,
59.89513365572524,
59.92622703731865,
60.079927728412294,
60.20742625050286,
61.4830715783496,
61.97349871531136,
62.8374499044859,
63.27894478111543,
63.611414089709186,
65.01621005520482,
65.23802480408182,
66.0033720791656,
66.00742274348062,
67.02007434547104,
67.15932493964198,
67.66016782208908,
67.67694715295671,
67.92039191628974,
68.02999307671021,
68.16273727526905,
68.86686112105924,
69.01760532297115,
69.20275728024347,
69.36023915445678,
69.86855783375313,
70.6632377834112,
70.76351645525763,
70.96413895998924,
71.12617574614903,
71.67170283169726,
72.42817456735943,
73.28173287349448,
73.57880457665607,
73.60334622389884,
73.85385349954495,
74.08982800337868,
74.31238330604947,
74.38089317916977,
74.95415155047078,
75.9104631398038,
76.18407204127709,
77.0276808133645,
77.24964315979979,
77.53464729959063,
77.77267312621451,
78.2914616666747,
78.42902821137885,
78.54710166483929,
79.09293330596043,
79.3140640919384,
79.58959510833871,
79.76377924561005,
80.51769254360556,
80.67252046531755,
80.97990838736138,
81.71431336019577,
82.0875497375325,
82.12845231123974,
82.4520767109154,
83.76849010976585,
84.79896491050272,
84.90177622878025,
85.12350003212538,
85.56421097843265,
86.04897332212904,
86.29521290369759,
86.76811338759875,
86.82305359190353,
87.43884255977189,
87.9519215425067,
88.6258248117941,
89.86297445754334,
90.03393524491493,
90.66188541207029,
91.2942973606583,
91.30380061269184,
92.44945121245628,
92.69658925344945,
93.13384369129851,
93.44293089131271,
93.7897973679008,
95.60686728808216,
96.97464530534194,
97.2611117294075,
97.91482417898213,
99.42998571238596,
100.90228653284402,
101.48508024212146,
102.13192133452564,
102.26933643148938,
102.46926526957078,
102.84845248385496,
103.04980836460429,
103.26707907896886,
104.20582602262913,
105.34390779888254,
105.5597205788687,
106.88072342076048,
107.14210893290684,
107.56712587448551,
107.63744537879688,
108.03654465032507,
109.19502852010478,
109.66242427944124,
110.59231393587842,
112.4854978927197,
112.6109178707508,
113.47749045318974,
114.32504322189419,
114.59636156444634,
114.67942027490102,
115.04165035240332,
115.15484519038372,
115.96713445737484,
116.65969917508441,
116.98385075091652,
117.50095824942136,
118.38898190286687,
118.8698619371188,
120.21085668522223,
120.37526163071827,
120.62344415060163,
120.80853127344831,
121.06012576350602,
121.36572212912174,
122.18768103622455,
123.07716615813412,
123.5771080389173,
123.63741357574976,
124.04528594606742,
124.16388326088794,
124.21169391691656,
124.53623395147812,
124.719153126174,
124.85985104845206,
126.10879055305084,
126.18611695249037,
126.62702419354834,
126.85389460314993,
129.2147524007052,
129.45885240549714,
129.56619559454435,
129.59736076007758,
129.97175746466226,
130.0683861947823,
130.55079903436683,
131.50946353695042,
131.7177478034859,
132.0352612118799,
133.15472873190743,
133.28564520220766,
133.8611117276719,
134.41292269339806,
134.97492257286578,
137.24670377366306,
137.5779316202657,
138.03072229678455,
138.9970157137652,
140.2804528863813,
140.68078089171564,
141.5845800391211,
141.61698743452112,
141.63105098907258,
141.6348049438121,
142.73075760432292,
143.87527622039948,
146.2970479530806,
147.06633290172903,
147.5011452225722,
149.46484327654989,
150.44257325515406,
151.67123243069975,
151.75192831988582,
152.76870364111406,
152.86930640310683,
154.01896073343434,
154.39796712219405,
154.41365178889126,
155.73942108446658,
156.06213782077396,
156.84845568169408,
157.87649008268977,
158.37741519509433,
159.14680028163866,
159.859898031095,
159.88839213023252,
160.43066124052524,
160.44355908287372,
160.73832087587704,
160.78337085637423,
161.04024173781903,
161.13161061641702,
161.40694465097837,
161.49578438897856,
162.69889392496157,
163.2766245371968,
164.19956605675674,
164.23652589573246,
164.96995832332868,
167.77720107961733,
169.34448666217844,
169.69569000775425,
170.90602740655885,
173.1134444904436,
175.20028010267654,
175.89244657654524,
176.05117595486428,
176.6706135535206,
176.70777865965698,
177.11314486255122,
178.02868946219127,
179.96645239940898,
180.0487397780874,
180.1678741017776,
180.47584126524018,
181.62069663206552,
184.085945631465,
184.42994367300471,
184.65956542787947,
186.746007312876,
187.10305291998637,
187.83772577793303,
189.30892779170185,
190.78840454897258,
193.14160250268483,
193.80400622566864,
194.3345518986921,
194.41498743337206,
198.38555467079203,
198.69036083929112,
198.80143434150577,
199.97063810806392,
202.3656257199924,
202.9625272932853,
204.8884462207469,
205.08887971165584,
205.6835865341972,
205.83237283672108,
206.9684415836247,
210.5661665890983,
211.19122162627636,
212.21691485753763,
213.38370494874127,
213.5705280093299,
213.72382673486317,
215.9510623779015,
220.33986452710917,
220.37009505833439,
220.673092700518,
221.1840438286831,
221.78025945946212,
222.8451860371413,
223.4744304949091,
223.59441112103863,
223.82015206371963,
225.1930970093633,
225.3981347104493,
225.46577996658866,
226.02671576912948,
229.59251690265742,
230.21561092868117,
230.73744048385427,
230.77864183710582,
232.42520014365343,
232.81290523463875,
232.8869713923169,
234.5789908207353,
238.47974819994027,
238.8069100991557,
239.91664158042232,
240.68932927100326,
241.65394383311565,
245.88690452417686,
246.04192247545106,
248.15485571132598,
249.6259748752243,
250.3546703673961,
254.74615617274654,
257.35004213220594,
257.9746639488659,
261.20520619077735,
265.11344837163875,
266.1988837765386,
266.6379689905607,
267.4990732196661,
267.75893231940154,
268.69425151192485,
268.89502538141306,
270.17444185874837,
270.953035067936,
270.96067233047904,
271.1695196807801,
272.9724780137386,
273.4226932362593,
274.9300145063612,
277.02259834189795,
277.59333396353014,
278.18623061236957,
278.7861766812261,
278.92522245576333,
279.29566760407454,
279.3843261923249,
280.0770488920493,
281.54325122693376,
282.78835854365417,
285.0190143782452,
286.4744117344803,
287.67942262858594,
289.61709016286443,
293.8391426043973,
294.00369995322063,
295.63842499995684,
297.59550143666706,
298.12907884032387,
298.9298119592167,
301.63090780262746,
303.02564938474154,
305.9365829187623,
308.5276136813139,
313.13117120951694,
313.4796827400057,
315.16313190859466,
316.6180250236188,
317.88883848553434,
318.024534415248,
321.12304740567987,
325.22367473508496,
327.4437337540067,
330.19303284325497,
330.5299080339913,
331.36297429717405,
335.9480394247435,
336.65874505629336,
338.5761466202221,
340.2178104858212,
341.08811194274506,
341.2457535359383,
341.81468508191296,
343.4119456797633,
347.2742213070024,
348.25167778249545,
348.93558139909413,
356.7924236296826,
357.2039470327864,
357.332003749679,
359.639387087053,
359.90529886518044,
360.19196370592886,
363.76325337691935,
370.04143726993385,
372.2554009694198,
375.85731927073977,
378.2844146485636,
378.31348353358374,
390.29014040585974,
391.852957700606,
392.67442221524215,
406.98748033460157,
415.0697764934579,
417.79696768051224,
420.3312915810157,
422.8581384857663,
424.6221745700868,
427.12039175912025,
431.93211964408425,
434.65712170040587,
439.2871626689536,
441.0853759734256,
455.1490365841038,
456.90583782478586,
459.5311339558049,
463.7416222248694,
463.80834320571745,
463.90621030299246,
477.05246229257017,
478.0291516554045,
481.2697409780844,
499.9473789677349,
501.9799824282643,
509.15789266287953,
511.220697790514,
516.6484363957951,
522.4124481094208,
524.6400979895302,
526.372710093015,
536.3449564745673,
540.4032541867214,
544.3078704041208,
545.3771188076053,
549.3340572150694,
550.9036269341342,
556.4442267015281,
556.6013091098121,
557.8516003776722,
560.7976834198471,
580.00686581924,
581.9857586002663,
586.8066841275754,
592.0616908222073,
594.9139480398246,
595.3568319095481,
595.7817770982847,
598.7204820748332,
600.1463553342271,
603.3199216556153,
604.2346540192675,
607.0333653996905,
624.5352250653671,
624.557617466895,
626.132696915494,
628.7756843606148,
634.4612343229852,
635.2560259590972,
638.4272794798817,
641.1697225193211,
642.7637636304752,
653.1395253614608,
656.5956832037739,
659.9670786603951,
666.991147255964,
668.1417217698139,
670.7561363898185,
680.5166068188737,
684.8042844863946,
690.3165044717932,
693.1991384955671,
694.432396716552,
697.3065557764194,
698.560030119017,
701.6190604888377,
710.0169634322832,
715.358910424832,
718.8060284052665,
720.0206375533196,
729.8686795492295,
738.3354819931296,
747.5211966695307,
747.6593164145777,
787.9929576327229,
795.8263441262618,
804.1232116944873,
813.9463340344738,
839.544075566623,
849.2303478862359,
867.8846866000438,
876.6756255183053,
878.1072162594487,
879.7110352895207,
899.5226136364968,
907.1244196497692,
922.9004287766971,
953.0358472822511,
971.1253149174076,
971.7318323841288,
974.1536153095204,
997.3373287857958,
1005.245217833552,
1017.2992933654416,
1037.8405324176244,
1112.504805580572,
1153.048367280003,
1174.81406171507,
1179.7250480881228,
1193.9008700223596,
1215.9663272963176,
1233.0780820496477,
1256.8477054369905,
1276.9223674378713,
1279.6523861296826,
1297.090423205319,
1309.703798359148,
1410.7160256889788,
1412.1870080029107,
1597.8214286812502,
1617.4725950150555,
1620.1824974463004,
1664.5044122689087,
1687.2875870529413,
1723.2021582464135,
1914.2081308480363,
2200.2268557717853,
2259.4144834686454,
2407.1185436587516,
2498.7715877088954,
2504.916727662431,
2572.569994334661,
2713.5043731817937,
3113.157579710069,
3205.430381536421,
3557.899623778879,
3615.934742129812,
4018.2452998412523,
4165.654908676019,
4682.485803099183,
4927.054318118251,
5530.789792652713,
5768.601152700881,
6143.075765424964,
6167.9081527214585,
6618.539648020924,
6824.615091169331,
11227.202528368096,
12995.372467743715,
13315.348507633755,
14799.971747323683,
17092.874797857596,
20011.68804843072,
23418.667829477217,
94651.79677112932,
425452.80183140526
])
# m = levs.max()
n = levs.size
inds = (n - numpy.arange(n)).astype(float)

diffs = numpy.diff(levs)
print(levs.astype(int))
print((diffs / levs[1:] * numpy.log(inds[1:]) * 1000).astype(int))

# def fitval(alpha):
    # return abs(levs - m * inds ** (-alpha)).sum()
    
# import scipy.optimize

# alpha_bounds = (1.0,3.0)
# res = scipy.optimize.minimize_scalar(
    # fitval,
    # bracket=alpha_bounds,
# )
# print(res)
# alpha = res.x
# estim = m * inds ** (-alpha)
# rats = levs / estim
# print(levs.astype(int))
# print(estim.astype(int))
# print((rats * 10000).astype(int))


# class PowerLawEstimator:
    # def fit(x, xmin=None):
        # vec     = []
        # sample  = []
        # xminx   = []
        # limit   = []
        # finite  = False
        # nowarn  = False

        # xsorted = numpy.sort(x)
        # xmins = list(zip(numpy.unique(xsorted, return_index=True)))[:-1]
        # xmin_quals = []
        
        # for xmin, i_xmin in xmins:
            # xin = xsorted[i_xmin:]

            # # estimate alpha using direct MLE
            # a = self._fit_alpha(xin, xmin)
            # ks_stat = self._kolmogorov_smirnov(xin, xmin, a)
            # a_quals
            # # compute KS statistic
            # #cx   = map(lambda X:float(X)/n,range(0,n))
            
            # dat.append( max( map(lambda X: abs(cf[X]-float(X)/n),range(0,n))))
        # D     = min(dat)
        # xmin  = xmins[dat.index(D)]
        # z     = list(filter(lambda X:X>=xmin,x))
        # z.sort()
        # n     = len(z)
        # alpha = 1 + n / sum(map(lambda X: math.log(float(X)/xmin),z))
        # if finite: alpha = alpha*float(n-1)/n+1./n  # finite-size correction

        # L = n*math.log((alpha-1)/xmin) - alpha*sum(map(lambda X: math.log(float(X)/xmin),z))

        # return [alpha,xmin,L]
        
    # def _fit_alpha(x, xmin):
        # return 1 + x.size / numpy.log(x / xmin).sum()
        
    # def _kolmogorov_smirnov(x, xmin, a):
        # n = x.size
        # return (numpy.abs(1 - (xmin / x) ** (a - 1) - numpy.arange(n)) / n).max()

    # for lev in levels:
        # print(lev)
    # raise RuntimeError
    # fracs = levels.cumsum()
    # fracs /= fracs[-1]
    # # fitlevels = levels[levels > 1000]
    # expon = 1 + len(levels) / numpy.log(levels).sum()
    # inds = fracs.size - numpy.arange(fracs.size)
    # ests = levels.max() * inds ** (-expon)
    # # print((fracs * 10000).astype(int))
    # print(levels.astype(int))
    # print(expon)
    # print(inds)
    # print(ests.astype(int))
    # # print(plfit(levels.tolist()))
    # raise RuntimeError
    # import matplotlib.pyplot as plt
    # plt.scatter(numpy.arange(len(levels)), levels)
    # plt.show()



